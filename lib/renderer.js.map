{"version":3,"sources":["../src/renderer.js"],"names":[],"mappings":"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","file":"renderer.js","sourcesContent":["import utils from \"./utils\";\n\nconst Renderer = function(boardElement, { hooks, options }) {\n  this.INTERSECTION_GAP_SIZE = 28;\n  this.GUTTER_MARGIN = this.INTERSECTION_GAP_SIZE - 3;\n  this.BASE_MARGIN = this.INTERSECTION_GAP_SIZE - 10;\n  this.hasCoordinates = boardElement.hasAttribute(\"data-include-coordinates\");\n  this.MARGIN = this.hasCoordinates ? this.BASE_MARGIN + this.GUTTER_MARGIN : this.BASE_MARGIN;\n  this.boardElement = boardElement;\n  this.grid = [];\n  this.hooks = hooks || {};\n  this._options = options || {};\n  this._initialized = false;\n\n  if (this._options[\"fuzzyStonePlacement\"]) {\n    utils.addClass(boardElement, \"tenuki-fuzzy-placement\");\n    utils.addClass(boardElement, \"tenuki-board-textured\");\n    this.smallerStones = true;\n  }\n\n  if (utils.hasClass(boardElement, \"tenuki-board-textured\")) {\n    this.texturedStones = true;\n  }\n};\n\nRenderer.hoshiPositionsFor = function(boardSize) {\n  const hoshiElements = [];\n\n  if (boardSize < 7) {\n    if (boardSize > 1 && boardSize % 2 === 1) {\n      const hoshi = {};\n      hoshi.top = (boardSize - 1)/2;\n      hoshi.left = hoshi.top;\n\n      hoshiElements.push(hoshi);\n    } else {\n      // no hoshi\n    }\n  } else {\n    const hoshiOffset = boardSize > 11 ? 3 : 2;\n\n    for (let hoshiY = 0; hoshiY < 3; hoshiY++) {\n      for (let hoshiX = 0; hoshiX < 3; hoshiX++) {\n        if ((boardSize === 7 || boardSize % 2 === 0) && (hoshiY === 1 || hoshiX === 1)) {\n          continue;\n        }\n\n        const hoshi = {};\n\n        if (hoshiY === 0) {\n          hoshi.top = hoshiOffset;\n        }\n\n        if (hoshiY === 1) {\n          hoshi.top = (boardSize + 1)/2 - 1;\n        }\n\n        if (hoshiY === 2) {\n          hoshi.top = boardSize - hoshiOffset - 1;\n        }\n\n        if (hoshiX === 0) {\n          hoshi.left = hoshiOffset;\n        }\n\n        if (hoshiX === 1) {\n          hoshi.left = (boardSize + 1)/2 - 1;\n        }\n\n        if (hoshiX === 2) {\n          hoshi.left = boardSize - hoshiOffset - 1;\n        }\n\n        hoshiElements.push(hoshi);\n      }\n    }\n  }\n\n  return hoshiElements;\n};\n\nRenderer.prototype = {\n  _setup: function(boardState) {\n    const renderer = this;\n    const boardElement = this.boardElement;\n\n    renderer.BOARD_LENGTH = 2*this.MARGIN + (boardState.boardSize - 1)*(this.INTERSECTION_GAP_SIZE + 1);\n\n    const innerContainer = utils.createElement(\"div\", { class: \"tenuki-inner-container\" });\n    renderer.innerContainer = innerContainer;\n    utils.appendElement(boardElement, innerContainer);\n\n    const zoomContainer = utils.createElement(\"div\", { class: \"tenuki-zoom-container\" });\n    renderer.zoomContainer = zoomContainer;\n    utils.appendElement(innerContainer, zoomContainer);\n\n    renderer.cancelZoomElement = utils.createElement(\"div\", { class: \"cancel-zoom\" });\n    const cancelZoomBackdrop = utils.createElement(\"div\", { class: \"cancel-zoom-backdrop\" });\n    utils.addEventListener(renderer.cancelZoomElement, \"click\", function(event) {\n      event.preventDefault();\n      renderer.zoomOut();\n\n      return false;\n    });\n    utils.addEventListener(cancelZoomBackdrop, \"click\", function(event) {\n      event.preventDefault();\n      renderer.zoomOut();\n\n      return false;\n    });\n    utils.appendElement(innerContainer, renderer.cancelZoomElement);\n    utils.appendElement(innerContainer, cancelZoomBackdrop);\n\n    // https://developer.mozilla.org/en-US/docs/Web/Events/resize\n    const throttle = function(type, name) {\n      let running = false;\n      const func = function() {\n        if (running) { return; }\n\n        running = true;\n\n        window.requestAnimationFrame(function() {\n          window.dispatchEvent(new CustomEvent(name));\n          running = false;\n        });\n      };\n      window.addEventListener(type, func);\n    };\n\n    throttle(\"resize\", \"optimizedResize\");\n\n    this.generateBoard(boardState);\n\n    renderer.computeSizing();\n\n    // we'll potentially be zooming on touch devices\n    zoomContainer.style.willChange = \"transform\";\n\n    window.addEventListener(\"optimizedResize\", () => {\n      renderer.computeSizing();\n    });\n\n    renderer.touchmoveChangedTouch = null;\n    renderer.touchstartEventHandler = renderer.handleTouchStart.bind(renderer);\n    renderer.touchmoveEventHandler = renderer.handleTouchMove.bind(renderer);\n    renderer.touchendEventHandler = renderer.handleTouchEnd.bind(renderer);\n\n    utils.addEventListener(renderer.innerContainer, \"touchstart\", renderer.touchstartEventHandler);\n    utils.addEventListener(renderer.innerContainer, \"touchend\", renderer.touchendEventHandler);\n    utils.addEventListener(renderer.innerContainer, \"touchmove\", renderer.touchmoveEventHandler);\n  },\n\n  computeSizing: function() {\n    const renderer = this;\n    const innerContainer = this.innerContainer;\n    const zoomContainer = this.zoomContainer;\n    const boardElement = this.boardElement;\n\n    // reset everything so we can calculate against new values\n    innerContainer.style.height = \"\";\n    innerContainer.style.width = \"\";\n    zoomContainer.style.height = \"\";\n    zoomContainer.style.width = \"\";\n    innerContainer.style.transform = \"\";\n    // zoomContainer.style.willChange = \"\";\n    boardElement.style.width = \"\";\n    boardElement.style.height = \"\";\n\n    // dev-friendly reset of whether this is a touch device\n    renderer._touchEventFired = null;\n\n    innerContainer.style.width = renderer.BOARD_LENGTH + \"px\";\n    innerContainer.style.height = renderer.BOARD_LENGTH + \"px\";\n\n    zoomContainer.style.width = renderer.BOARD_LENGTH + \"px\";\n    zoomContainer.style.height = renderer.BOARD_LENGTH + \"px\";\n\n    const scaleX = innerContainer.parentNode.clientWidth / innerContainer.clientWidth;\n    const scaleY = innerContainer.parentNode.clientHeight / innerContainer.clientHeight;\n    const scale = Math.min(scaleX, scaleY);\n\n    if (scale > 0) {\n      if (scale < 1) {\n        utils.addClass(boardElement, \"tenuki-scaled\");\n      } else {\n        utils.removeClass(boardElement, \"tenuki-scaled\");\n      }\n\n      if (scale < 1 || scale > 1) {\n        innerContainer.style[\"transform-origin\"] = \"top left\";\n        innerContainer.style.transform = \"scale3d(\" + scale + \", \" + scale + \", 1)\";\n      }\n    }\n\n    // reset the outer element's height to match, ensuring that we free up any lingering whitespace\n    boardElement.style.width = innerContainer.getBoundingClientRect().width + \"px\";\n    boardElement.style.height = innerContainer.getBoundingClientRect().height + \"px\";\n\n    // Work around lack of re-raster in Chrome. See https://github.com/w3c/csswg-drafts/issues/236\n    // and https://bugs.chromium.org/p/chromium/issues/detail?id=600482 for more\n    // information. This is preventing, e.g., horizontal/vertical line width\n    // mismatches after scaling. By adding this, lines are re-rastered and are\n    // all the same width, as if the user had hit refresh at the new viewport\n    // size.\n    zoomContainer.style.willChange = \"\";\n\n    window.requestAnimationFrame(() => {\n      zoomContainer.style.willChange = \"transform\";\n    });\n  },\n\n  addIntersectionEventListeners: function(element, y, x) {\n    const renderer = this;\n\n    utils.addEventListener(element, \"mouseenter\", function() {\n      const hoveredYPosition = y;\n      const hoveredXPosition = x;\n      const hoverValue = renderer.hooks.hoverValue(hoveredYPosition, hoveredXPosition);\n\n      if (hoverValue) {\n        utils.addClass(element, \"hovered\");\n        utils.addClass(element, hoverValue);\n      }\n    });\n\n    utils.addEventListener(element, \"mouseleave\", function() {\n      if (utils.hasClass(this, \"hovered\")) {\n        utils.removeClass(element, \"hovered\");\n        utils.removeClass(element, \"black\");\n        utils.removeClass(element, \"white\");\n      }\n\n      renderer.resetTouchedPoint();\n    });\n\n    utils.addEventListener(element, \"click\", function() {\n      const playedYPosition = y;\n      const playedXPosition = x;\n\n      // if this isn't part of a touch,\n      // or it is and the user is zoomed in,\n      // or it's game over and we're marking stones dead,\n      // then don't use the zoom/double-select system.\n      if (!renderer._touchEventFired || (document.body.clientWidth / window.innerWidth > 1) || renderer.hooks.gameIsOver()) {\n        renderer.hooks.handleClick(playedYPosition, playedXPosition);\n        return;\n      }\n\n      if (renderer.touchedPoint) {\n        if (element === renderer.touchedPoint) {\n          renderer.hooks.handleClick(playedYPosition, playedXPosition);\n        } else {\n          renderer.showPossibleMoveAt(element, playedYPosition, playedXPosition);\n        }\n      } else {\n        renderer.showPossibleMoveAt(element, playedYPosition, playedXPosition);\n      }\n    });\n  },\n\n  handleTouchStart: function(event) {\n    const renderer = this;\n    renderer._touchEventFired = true;\n\n    if (event.touches.length > 1) {\n      if (renderer.zoomedIn) {\n        event.preventDefault();\n      }\n      return;\n    }\n\n    if (!renderer.zoomedIn) {\n      return;\n    }\n\n    const xCursor = event.changedTouches[0].clientX;\n    const yCursor = event.changedTouches[0].clientY;\n\n    renderer.dragStartX = xCursor;\n    renderer.dragStartY = yCursor;\n    renderer.zoomContainer.style.transition = \"none\";\n    renderer.animationFrameRequestID = window.requestAnimationFrame(renderer.processDragDelta.bind(renderer));\n  },\n\n  handleTouchMove: function(event) {\n    const renderer = this;\n\n    if (event.touches.length > 1) {\n      return;\n    }\n\n    if (!renderer.zoomedIn) {\n      return true;\n    }\n\n    // prevent pull-to-refresh\n    event.preventDefault();\n\n    renderer.touchmoveChangedTouch = event.changedTouches[0];\n\n    renderer.moveInProgress = true;\n  },\n\n  handleTouchEnd: function(event) {\n    const renderer = this;\n\n    if (event.touches.length > 1) {\n      return;\n    }\n\n    if (!renderer.zoomedIn) {\n      return;\n    }\n\n    renderer.zoomContainer.style.transition = \"\";\n\n    if (!renderer.moveInProgress) {\n      return;\n    }\n    renderer.translateY = renderer.lastTranslateY;\n    renderer.translateX = renderer.lastTranslateX;\n    renderer.moveInProgress = false;\n    renderer.touchmoveChangedTouch = null;\n    window.cancelAnimationFrame(renderer.animationFrameRequestID);\n  },\n\n  processDragDelta: function() {\n    const renderer = this;\n\n    if (!renderer.touchmoveChangedTouch) {\n      renderer.animationFrameRequestID = window.requestAnimationFrame(renderer.processDragDelta.bind(renderer));\n      return;\n    }\n\n    const innerContainer = renderer.innerContainer;\n\n    const xCursor = renderer.touchmoveChangedTouch.clientX;\n    const yCursor = renderer.touchmoveChangedTouch.clientY;\n\n    const deltaX = xCursor - renderer.dragStartX;\n    const deltaY = yCursor - renderer.dragStartY;\n\n    let translateY = renderer.translateY + deltaY/2.5;\n    let translateX = renderer.translateX + deltaX/2.5;\n\n    if (translateY > 0.5*innerContainer.clientHeight - renderer.MARGIN) {\n      translateY = 0.5*innerContainer.clientHeight - renderer.MARGIN;\n    }\n\n    if (translateX > 0.5*innerContainer.clientWidth - renderer.MARGIN) {\n      translateX = 0.5*innerContainer.clientWidth - renderer.MARGIN;\n    }\n\n    if (translateY < -0.5*innerContainer.clientHeight + renderer.MARGIN) {\n      translateY = -0.5*innerContainer.clientHeight + renderer.MARGIN;\n    }\n\n    if (translateX < -0.5*innerContainer.clientWidth + renderer.MARGIN) {\n      translateX = -0.5*innerContainer.clientWidth + renderer.MARGIN;\n    }\n\n    renderer.zoomContainer.style.transform = \"translate3d(\" + 2.5*translateX + \"px, \" + 2.5*translateY + \"px, 0) scale3d(2.5, 2.5, 1)\";\n\n    renderer.lastTranslateX = translateX;\n    renderer.lastTranslateY = translateY;\n\n    renderer.animationFrameRequestID = window.requestAnimationFrame(renderer.processDragDelta.bind(renderer));\n  },\n\n  showPossibleMoveAt: function(intersectionElement, y, x) {\n    const renderer = this;\n    const boardElement = this.boardElement;\n    const zoomContainer = this.zoomContainer;\n\n    renderer.zoomContainerHeight = renderer.zoomContainerHeight || zoomContainer.clientHeight;\n    renderer.zoomContainerWidth = renderer.zoomContainerWidth || zoomContainer.clientWidth;\n\n    renderer.touchedPoint = intersectionElement;\n\n    if (utils.hasClass(boardElement, \"tenuki-scaled\")) {\n      const top = y * (this.INTERSECTION_GAP_SIZE + 1);\n      const left = x * (this.INTERSECTION_GAP_SIZE + 1);\n\n      const translateY = 0.5 * renderer.zoomContainerHeight - top - renderer.MARGIN;\n      const translateX = 0.5 * renderer.zoomContainerWidth - left - renderer.MARGIN;\n\n      zoomContainer.style.transform = \"translate3d(\" + 2.5*translateX + \"px, \" + 2.5*translateY + \"px, 0) scale3d(2.5, 2.5, 1)\";\n      renderer.translateY = translateY;\n      renderer.translateX = translateX;\n\n      utils.addClass(renderer.cancelZoomElement, \"visible\");\n      renderer.zoomedIn = true;\n    }\n  },\n\n  resetTouchedPoint: function() {\n    const renderer = this;\n\n    renderer.touchedPoint = null;\n  },\n\n  zoomOut: function() {\n    const renderer = this;\n\n    this.resetTouchedPoint();\n    renderer.zoomContainer.style.transform = \"\";\n    renderer.zoomContainer.style.transition = \"\";\n    renderer.dragStartX = null;\n    renderer.dragStartY = null;\n    renderer.translateY = null;\n    renderer.translateX = null;\n    renderer.lastTranslateX = null;\n    renderer.lastTranslateY = null;\n\n    utils.removeClass(renderer.cancelZoomElement, \"visible\");\n    renderer.zoomedIn = false;\n  },\n\n  render: function(boardState, { territory, deadStones } = {}) {\n    if (!this._initialized) {\n      this._setup(boardState);\n      this._initialized = true;\n    }\n\n    this.resetTouchedPoint();\n\n    this.renderStonesPlayed(boardState.intersections);\n\n    const playedPoint = boardState.playedPoint;\n\n    this.updateMarkerPoints({ playedPoint: playedPoint, koPoint: boardState.koPoint });\n\n    if (this._options[\"fuzzyStonePlacement\"] && playedPoint) {\n      const verticalShiftClasses = [\n        \"v-shift-up\",\n        \"v-shift-upup\",\n        \"v-shift-down\",\n        \"v-shift-downdown\",\n        \"v-shift-none\"\n      ];\n\n      const horizontalShiftClasses = [\n        \"h-shift-left\",\n        \"h-shift-leftleft\",\n        \"h-shift-right\",\n        \"h-shift-rightright\",\n        \"h-shift-none\"\n      ];\n\n      const shiftClasses = verticalShiftClasses.concat(horizontalShiftClasses);\n\n      const alreadyShifted = shiftClasses.some(c => utils.hasClass(this.grid[playedPoint.y][playedPoint.x], c));\n\n      if (!alreadyShifted) {\n        const possibleShifts = utils.cartesianProduct(verticalShiftClasses, horizontalShiftClasses);\n        const [playedVerticalShift, playedHorizontalShift] = possibleShifts[Math.floor(Math.random() * possibleShifts.length)];\n\n        [\n                   [-1, 0],\n          [0, -1],          [0, 1],\n                    [1, 0]\n        ].forEach(([y, x]) => {\n          if (this.grid[playedPoint.y + y] && this.grid[playedPoint.y + y][playedPoint.x + x]) {\n            const neighboringElement = this.grid[playedPoint.y + y][playedPoint.x + x];\n\n            if (!utils.hasClass(neighboringElement, \"empty\")) {\n              [\n                [-1, 0, \"v-shift-downdown\", \"v-shift-up\", \"v-shift-down\"],\n                [-1, 0, \"v-shift-downdown\", \"v-shift-upup\", \"v-shift-none\"],\n                [-1, 0, \"v-shift-down\", \"v-shift-upup\", \"v-shift-none\"],\n                [1, 0, \"v-shift-upup\", \"v-shift-down\", \"v-shift-up\"],\n                [1, 0, \"v-shift-upup\", \"v-shift-downdown\", \"v-shift-none\"],\n                [1, 0, \"v-shift-up\", \"v-shift-downdown\", \"v-shift-none\"],\n\n                [0, -1, \"h-shift-rightright\", \"h-shift-left\", \"h-shift-right\"],\n                [0, -1, \"h-shift-rightright\", \"h-shift-leftleft\", \"h-shift-none\"],\n                [0, -1, \"h-shift-right\", \"h-shift-leftleft\", \"h-shift-none\"],\n                [0, 1, \"h-shift-leftleft\", \"h-shift-right\", \"h-shift-left\"],\n                [0, 1, \"h-shift-leftleft\", \"h-shift-rightright\", \"h-shift-none\"],\n                [0, 1, \"h-shift-left\", \"h-shift-rightright\", \"h-shift-none\"]\n              ].forEach(([requiredYOffset, requiredXOffset, requiredNeighborShift, conflictingPlayedShift, newNeighborShift]) => {\n                if (y === requiredYOffset && x === requiredXOffset && utils.hasClass(neighboringElement, requiredNeighborShift) && (playedVerticalShift === conflictingPlayedShift || playedHorizontalShift === conflictingPlayedShift)) {\n                  utils.removeClass(neighboringElement, requiredNeighborShift);\n                  utils.addClass(neighboringElement, newNeighborShift);\n                }\n              });\n            }\n          }\n        });\n\n        utils.addClass(this.grid[playedPoint.y][playedPoint.x], playedVerticalShift);\n        utils.addClass(this.grid[playedPoint.y][playedPoint.x], playedHorizontalShift);\n      }\n    }\n\n    if (territory) {\n      this.renderTerritory(territory, deadStones);\n    }\n  },\n\n  renderStonesPlayed: function(intersections) {\n    intersections.forEach(intersection => {\n      this.renderIntersection(intersection);\n    });\n  },\n\n  updateMarkerPoints: function({ playedPoint, koPoint }) {\n    const renderer = this;\n\n    if (koPoint) {\n      utils.addClass(renderer.grid[koPoint.y][koPoint.x], \"ko\");\n    }\n\n    if (playedPoint) {\n      utils.addClass(renderer.grid[playedPoint.y][playedPoint.x], \"played\");\n    }\n  },\n\n  renderIntersection: function(intersection) {\n    const renderer = this;\n\n    const intersectionEl = renderer.grid[intersection.y][intersection.x];\n\n    let classes = [\"intersection\"];\n\n    if (intersection.isEmpty()) {\n      classes.push(\"empty\");\n    } else {\n      classes.push(\"occupied\");\n\n      if (intersection.isBlack()) {\n        classes.push(\"black\");\n      } else {\n        classes.push(\"white\");\n      }\n\n      const shiftClasses = [\n        \"v-shift-up\",\n        \"v-shift-upup\",\n        \"v-shift-down\",\n        \"v-shift-downdown\",\n        \"v-shift-none\",\n        \"h-shift-left\",\n        \"h-shift-leftleft\",\n        \"h-shift-right\",\n        \"h-shift-rightright\",\n        \"h-shift-none\"\n      ];\n\n      shiftClasses.forEach(shiftClass => {\n        if (utils.hasClass(intersectionEl, shiftClass)) {\n          classes.push(shiftClass);\n        }\n      });\n    }\n\n    this.setIntersectionClasses(intersectionEl, intersection, classes);\n  },\n\n  renderTerritory: function(territory, deadStones) {\n    utils.flatten(this.grid).forEach(element => {\n      utils.removeClass(element, \"territory-black\");\n      utils.removeClass(element, \"territory-white\");\n      utils.removeClass(element, \"dead\");\n    });\n\n    deadStones.forEach(point => {\n      utils.addClass(this.grid[point.y][point.x], \"dead\");\n    });\n\n    territory.black.forEach(territoryPoint => {\n      utils.addClass(this.grid[territoryPoint.y][territoryPoint.x], \"territory-black\");\n    });\n\n    territory.white.forEach(territoryPoint => {\n      utils.addClass(this.grid[territoryPoint.y][territoryPoint.x], \"territory-white\");\n    });\n  }\n};\n\nexport default Renderer;\n"]}